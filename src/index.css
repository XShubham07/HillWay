@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================================================
   1. GLOBAL THEME VARIABLES
   ========================================================= */
:root {
  --emerald: #059669;
  --alpine: #064e3b;
  --gold: #facc15;
  --gold-soft: rgba(250, 204, 21, 0.28);
  --emerald-glow: rgba(5, 150, 105, 0.22);
  --alpine-glow: rgba(6, 78, 59, 0.25);
  --dark: #0f172a;
}

/* =========================================================
   2. FULL PAGE 3D BACKGROUND THEME
   ========================================================= */
html,
body,
#root {
  width: 100%;
  min-height: 100vh;
  /* FIX: Removed 'isolation: isolate' to prevent stacking context bugs on mobile */
  background-color: var(--alpine);
  /* Fallback */
  color: var(--dark);
}

/* FIX: Moved gradient to a fixed pseudo-element.
   This prevents 'background-attachment: fixed' jitter on mobile.
*/
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg,
      var(--alpine) 0%,
      var(--emerald) 40%,
      #0d2d23 70%);
  z-index: -2;
  /* Hardware acceleration for background */
  transform: translateZ(0);
}

/* EMERALDâ€“GOLD RADIANCE LAYERS */
/* Using a separate div logic approach via pseudo-element */
body::after {
  content: "";
  position: fixed;
  inset: 0;
  background:
    radial-gradient(circle at top center, var(--gold-soft) 0%, transparent 50%),
    radial-gradient(circle at 20% 70%, var(--emerald-glow) 0%, transparent 55%),
    radial-gradient(circle at 85% 80%, var(--alpine-glow) 0%, transparent 60%);
  z-index: -1;
  pointer-events: none;
  /* FIX: Reduced blur slightly for performance */
  filter: blur(30px);
  transform: translateZ(0);
}

/* =========================================================
   3. RESET + LENIS
   ========================================================= */
html.lenis,
html.lenis body {
  height: auto;
}

.lenis.lenis-smooth {
  scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
  overscroll-behavior: contain;
}

.lenis.lenis-stopped {
  overflow: hidden;
}

body {
  margin: 0;
  padding: 0;
  font-family: "Inter", sans-serif;
  overflow-x: hidden;
  overscroll-behavior: none;
  -webkit-tap-highlight-color: transparent;
}

/* =========================================================
   4. SCROLLBAR
   ========================================================= */
html {
  scrollbar-width: thin;
  scrollbar-color: rgba(5, 150, 105, 0.4) transparent;
}

::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-thumb {
  background: rgba(5, 150, 105, 0.4);
  border-radius: 10px;
}

/* =========================================================
   5. UTILITIES
   ========================================================= */
.text-shadow {
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
}

/* =========================================================
   6. NAVBAR CLEAN
   ========================================================= */
.navbar-clean {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(12px);
  /* Slightly reduced for mobile perf */
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  /* FIX: Removed global 'will-change' to let browser decide */
}

.nav-link-clean {
  padding: .5rem 1rem;
  border-radius: .75rem;
  font-weight: 500;
  color: #e2e8f0;
  transition: all .3s ease;
}

.nav-link-clean:hover {
  background: rgba(250, 204, 21, 0.2);
  color: var(--gold);
}

/* =========================================================
   7. FEATURES GLASS CARDS (CRITICAL FIXES HERE)
   ========================================================= */
.glass-card {
  background: rgba(255, 255, 255, 0.22);
  /* FIX: -webkit- prefix ensures iOS supports the blur */
  -webkit-backdrop-filter: blur(14px);
  backdrop-filter: blur(14px);
  border: 1px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 8px 32px rgba(5, 150, 105, 0.25);
  border-radius: 32px;

  /* FIX: Removed 'contain: layout paint' as it clips children with Framer Motion sometimes */
  /* FIX: Removed 'transform: translateZ(0)' to allow Framer Motion to control the layer */
}

/* Gradient accent for icons & highlights */
.accent-gradient {
  background: linear-gradient(135deg, var(--emerald), var(--gold));
}

/* =========================================================
   8. MOBILE OPTIMIZATIONS & GPU HANDLING
   ========================================================= */

/* FIX: Only apply hover effects on devices that actually have hover */
@media (hover: hover) {
  .tour-card-mobile:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.18);
    z-index: 50;
  }
}

/* REDUCED MOTION PREFERENCE */
@media (prefers-reduced-motion: reduce) {

  .tour-card-mobile,
  .glass-card {
    animation-duration: 0s !important;
    transition-duration: 0s !important;
  }
}

/* CRITICAL FIX: 
   1. Removed .glass-card from "transform: none !important". 
      Framer Motion MUST control the transform.
   2. Removed 'will-change' from this block. 
      Framer Motion handles will-change via inline styles where needed.
*/
.btn-ripple {
  transform: translate3d(0, 0, 0);
  /* Force GPU only for ripple */
}

/* Specific fix for touch devices to prevent white flashes */
@media (max-width: 768px) {
  .glass-card {
    /* Slightly reduce complexity on old phones */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
}

/* Optimized Frosted Glass */
.glass-card {
  /* 1. Base High-Performance Translucency */
  background: rgba(255, 255, 255, 0.25);

  /* 2. The Frost Effect */
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  /* 3. Border & Shadow for Depth */
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-shadow:
    0 4px 6px rgba(0, 0, 0, 0.05),
    0 10px 15px rgba(0, 0, 0, 0.1);

  /* 4. Smooth rendering hints */
  will-change: transform, opacity;
  transform: translateZ(0);
  /* Hardware Acceleration */
}

/* Fallback for low-end devices that don't support backdrop-filter */
@supports not (backdrop-filter: blur(12px)) {
  .glass-card {
    background: rgba(255, 255, 255, 0.85);
    /* More opaque if no blur */
  }
}